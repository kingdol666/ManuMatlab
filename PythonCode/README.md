# 纵拉预热仿真系统用户手册 📖

**版本：1.2.0**

---

## 1. 🚀 系统简介

欢迎使用纵拉预热仿真系统！本系统是一款专为模拟和分析高分子材料（如PBAT）在纵拉预热过程中的热力学行为而设计的桌面应用程序。它提供了一个从参数配置、多工步模型搭建到仿真运行和结果分析的全流程解决方案。

借助本系统，工程师和研究人员可以：
-   **精确配置**：对材料属性、环境条件和几何参数进行精细化设置。
-   **灵活建模**：通过组合不同的升温和降温工序，构建复杂的工艺流程。
-   **高效仿真**：利用后台MATLAB引擎执行计算，同时保持界面的流畅响应。
-   **深度分析**：通过丰富的静态图表和动态动画，直观地理解仿真结果，洞察热传递规律。

## 2. 🛠️ 安装与环境要求

在运行本系统前，请确保您的环境满足以下要求：

1.  **Python 环境**: 推荐使用 Python 3.9 或更高版本。
2.  **MATLAB**: 必须安装 MATLAB R2023a 或更高版本，并确保已正确安装 **MATLAB Engine API for Python**。
3.  **依赖库**: 请通过 `pip` 安装所有必需的 Python 库。在项目根目录下打开终端，运行以下命令：
    ```bash
    pip install PyQt6 matplotlib numpy psutil
    ```
    -   `PyQt6`: 用于构建图形用户界面。
    -   `matplotlib`: 用于数据可视化和图表绘制。
    -   `numpy`: 用于高效的数值计算。
    -   `psutil`: 用于稳健地管理和终止系统进程（特别是MATLAB引擎），确保程序的稳定性。

## 3. 🗺️ 软件操作指南

本系统界面直观，主要功能通过顶部的选项卡进行组织。以下是每个模块的详细操作说明。

### 🌟 快速上手：一个典型的仿真流程

1.  **⚙️ 步骤一：配置参数**
    -   启动软件后，首先进入 **“配置参数”** 选项卡。
    -   根据您的实验需求，仔细填写 **网格参数** 和 **主要参数**。
    -   点击 **“保存配置”**，将当前设置存为默认值。

2.  **🏗️ 步骤二：搭建模型序列**
    -   切换到 **“模型管理”** 选项卡。
    -   在左侧面板中，设置第一个工步（**注意**：必须是“升温”和“初始辊”）。
    -   点击 **“添加模型”**，将其加入右侧的序列。
    -   继续添加后续的升温或降温工步，直到构建完成整个工艺流程。

3.  **▶️ 步骤三：运行仿真**
    -   进入 **“运行仿真”** 选项卡。
    -   点击 **“运行仿真”** 按钮。此时，界面会自动锁定模型管理功能，防止误操作。
    -   在 **“实时日志”** 窗口观察仿真进度。如果需要，可随时点击 **“终止仿真”** 来安全地停止计算。

4.  **📊 步骤四：分析结果**
    -   仿真完成后，切换到 **“结果可视化”** 选项卡。
    -   使用 **“显示整体温度云图”** 和 **“显示温度变化曲线”** 等功能来分析静态结果。
    -   切换到 **“运行可视化”** 选项卡，通过动画回放整个动态过程。

### 📑 各功能模块详解

#### ⚙️ 配置参数 (Configuration Tab)

此选项卡是所有仿真的基础，用于设定全局物理和数值参数。

-   **网格参数 (Mesh Params)**:
    -   `H` 和 `L`: 定义仿真模型的几何尺寸。
    -   `Nx` 和 `Ny`: 设置模型的网格密度。较高的值会提高计算精度，但也会显著增加计算时间。
-   **主要参数 (Main Params)**:
    -   **材料属性**: `k` (导热系数), `midu` (密度), `Cv` (比热容)。
    -   **热交换**: `q` (热通量), `alpha` 和 `alpha1` (对流换热系数)。
    -   **温度条件**: `T_kongqi` (环境温度), `T0` (初始温度)。
    -   **时间控制**: `t` (总仿真时间), `dt` (时间步长)。

#### 🏗️ 模型管理 (Model Management Tab)

在这里，您可以像搭积木一样构建复杂的工艺流程。

-   **左侧面板 (模型配置)**:
    -   **脚本类型**: 选择“升温”或“降温”。
    -   **滚动方向**: 对于升温辊，可选择“初始辊”、“正向”或“反向”。
    -   **操作技巧**: **第一个模型必须是“升温”且方向为“初始辊”**，否则仿真将无法正确初始化。
-   **右侧面板 (模型序列)**:
    -   **编辑**: **双击** 表格中的单元格，可以直接修改该工步的参数。
    -   **删除**: 在表格中选中一行或多行，然后点击 **“删除选中模型”** 或 **“删除所有模型”**。
    -   **保存与加载**: 使用 **“保存模型序列”** 和 **“加载模型序列”** 按钮，可以方便地复用和分享复杂的工艺流程。

#### ▶️ 运行仿真 (Run Simulation Tab)

这是执行、监控和控制仿真的中央枢纽。

-   **核心控制**:
    -   **运行仿真**: 点击后，仿真将在后台线程中开始，界面保持流畅。
    -   **终止仿真**: 这是一个安全开关。无论仿真进行到哪一步，点击它都会平滑地停止后台引擎，并重置UI状态，不会导致程序卡死。
-   **实时监控**:
    -   **实时日志**: 提供详细的、带时间戳的运行记录，是排查问题的关键。
    -   **仿真进度**: 进度条直观显示任务完成的百分比和当前步数。

#### 📊 结果可视化 (Results Visualization Tab)

仿真结束后，这里是您深入分析数据的地方。

-   **数据管理**:
    -   **加载/保存结果**: 您可以将一次完整的仿真输出（包含所有步骤的详细数据）保存为单个 `.json` 文件，方便日后随时加载和重新分析。
-   **可视化工具**:
    -   **显示整体温度云图**: 这是最有用的功能之一，它将所有工步的结果拼接成一张连续的、完整的温度云图，让您对整个工艺流程的热力学演变一目了然。
    -   **显示温度变化曲线**: 在一个独立的新窗口中，绘制模型关键位置的温度变化曲线，便于与主窗口的其他图表进行对比分析。
    -   **保存所有图片**: 一键将当前生成的所有图表导出为PNG图片。

#### 🎥 运行可视化 (Runtime Visualization Tab)

通过动态回放，让抽象的数据变得生动起来。

-   **动画回放**:
    -   一个简化的示意图会动态展示薄膜在加热辊和冷却区之间的移动过程。
    -   动画会同步显示每个工步的实时平均温度。
-   **交互式控制**:
    -   **倍速播放**: 加速或减速播放，快速定位您关心的环节。
    -   **逐帧控制**: 使用“上一步”和“下一步”按钮，可以像调试代码一样，精确地审查每一个时间步的状态。

## 4. 📞 技术支持

如果您在使用过程中遇到任何问题，或有任何建议，欢迎随时通过以下方式与我们联系：

-   **作者邮箱**：zhanghaozheng@mail.ustc.edu.cn
